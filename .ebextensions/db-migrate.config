

packages:
  yum:
    amazon-linux-extras: []

commands:
    01_postgres_activate:
        command: sudo amazon-linux-extras enable postgresql10
    02_postgres_install:
        command: sudo yum install -y postgresql-devel

container_commands:
  01_migration:
      command: "source /var/app/venv/*/bin/activate && python manage.py makemigrations"
  02_migrate:
      command: "source /var/app/venv/*/bin/activate && python manage.py migrate --noinput"
      leader_only: true
  03_createsuperuser:
      command: "source /var/app/venv/*/bin/activate && echo from accounts.models import Account; Account.objects.create_superuser('first_name', 'last_name', 'your-email@gmail.com', 'yourusername', 'password') | python manage.py shell"
      leader_only: true
  04_collectstatic:
      command: "source /var/app/venv/*/bin/activate && python manage.py collectstatic --noinput"
